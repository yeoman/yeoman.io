<!DOCTYPE html><html lang=en data-version=a6f837c><head><meta charset=utf-8><title>Testing Guidelines | Yeoman</title><meta name=viewport content="width=device-width"><link rel=icon type=image/x-icon href=/static/favicon.b25e58c4b8.ico><link href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Roboto:400,700,700italic,400italic" rel=stylesheet><link rel=stylesheet href=/static/bundle-5328.24d75b9b48.css><link href=/blog/atom.xml type=application/atom+xml rel=alternate title="Yeoman Blog Atom Feed"></head><body><header class=page-header><div class=container><div class=mobile-bar><h1 class=logo><a href="/"><img src=/static/logo.f0661e3819.png alt=Yeoman></a></h1><button class="mobile-menu-toggle ir">open</button></div><nav class=main-menu><ul class=main-nav><li><a href="/learning/">Using Yeoman</a><ul> <li><a href=/learning/index.html>Getting started</a></li> <li><a href=/codelab/index.html>Tutorial (codelab)</a></li> <li><a href=/learning/resources.html>Resources</a></li> <li><a href=/learning/deployment.html>Deployment</a></li> <li><a href=/learning/faq.html>FAQ</a></li> <li><a href=/learning/support.html>Support</a></li></ul></li><li><a href="/generators/">Discovering generators</a></li> <li><a href="/authoring/">Creating a generator</a><ul> <li><a href=/authoring/index.html>Getting started</a></li> <li><a href=/authoring/running-context.html>Running Context</a></li> <li><a href=/authoring/user-interactions.html>User Interactions</a></li> <li><a href=/authoring/composability.html>Composability</a></li> <li><a href=/authoring/dependencies.html>Managing Dependencies</a></li> <li><a href=/authoring/file-system.html>Interacting with the file system</a></li> <li><a href=/authoring/gruntfile.html>Creating a Gruntfile</a></li> <li><a href=/authoring/storage.html>Storing user configs</a></li> <li><a href=/authoring/testing.html>Unit testing</a></li> <li><a href=/authoring/debugging.html>Debugging Generators</a></li> <li><a href=/authoring/integrating-yeoman.html>Integrating Yeoman in other tools</a></li> <li><a href="http://yeoman.github.io/generator/">Full API documentation</a></li></ul></li><li><a href="/blog/">Blog</a></li> <li><a href="/contributing/" class=active>Contributing</a><ul> <li><a href=/contributing/index.html>Contributing</a></li> <li><a href=/contributing/opening-issues.html>How to open an issue</a></li> <li><a href=/contributing/pull-request.html>How to submit a PR</a></li> <li><a href=/contributing/style-guide.html>Style Guide</a></li> <li><a href=/contributing/testing-guidelines.html class=active>Testing Guidelines</a></li> <li><a href=/contributing/ticketing.html>Issue system overview</a></li></ul></li></ul></nav></div></header><div id=content><h2 class=page-title><div class=container>Testing Guidelines</div></h2><div class="container clearfix has-sidebar"><nav class=context-nav><ul><li><a href=/contributing/index.html>Contributing</a></li> <li><a href=/contributing/opening-issues.html>How to open an issue</a></li> <li><a href=/contributing/pull-request.html>How to submit a PR</a></li> <li><a href=/contributing/style-guide.html>Style Guide</a></li> <li><a href=/contributing/testing-guidelines.html class=active>Testing Guidelines</a></li> <li><a href=/contributing/ticketing.html>Issue system overview</a></li></ul></nav><article class=main><section class=content-chunk><p>This testing guide is based on Mocha BDD interface (<code>describe</code> / <code>it</code>).</p><h2>Main principles</h2><h4>Tests must be always start with a clean state</h4><p>This means prefer <code>beforeEach</code> to <code>before</code>. Re-instantiate objects before running each <code>it</code> blocks. Create every files required by a test in a <code>beforeEach</code> (or commit them in <code>fixtures/</code>). Reset any side effects done on the test environment after each test.</p><h4>Tests must be runnable in isolation</h4><p>Each test must pass if they're ran alone. You can run a single test by using <code>mocha test.js --grep 'test name'</code>.</p><h4>Stub most performance heavy operation</h4><p>When possible, always stub networks or other long operations.</p><p>We use <a href="http://sinonjs.org/">sinon.js</a> for most stubbing needs.</p><h2>Naming convention</h2><p><code>describe</code> blocks should cover three types of information: Object to be tested, method/property, circumstantial group (basically, "when <em>this</em>").</p><p><code>it</code> blocks cover assertions. They should use as few lines of code as possible. There should be as many <code>it</code> block as there is assertion on a method effect.</p><p>Instances methods and property should be prefixed by a bang sign (<code>#find()</code>). Static methods and property should be prefixed by a dot (<code>.exclude()</code>).</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// Given this object</span>
<span class=kd>function</span> <span class=nx>Class</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>this</span><span class=p>.</span><span class=nx>args</span> <span class=o>=</span> <span class=nx>nopt</span><span class=p>();</span>
<span class=p>};</span>
<span class=nx>Class</span><span class=p>.</span><span class=nx>exclude</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{};</span>
<span class=nx>Class</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=s1>'Yeoman'</span><span class=p>;</span>
<span class=nx>Class</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>find</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{};</span>

<span class=c1>// We'd have this test structure</span>
<span class=nx>describe</span><span class=p>(</span><span class=s1>'Class'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=nx>describe</span><span class=p>(</span><span class=s1>'.exclude()'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{});</span>
  <span class=nx>describe</span><span class=p>(</span><span class=s1>'.name'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{});</span>
  <span class=nx>describe</span><span class=p>(</span><span class=s1>'#find()'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{});</span>
  <span class=nx>describe</span><span class=p>(</span><span class=s1>'#args'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{});</span>
<span class=p>});</span>
</code></pre></div><p>Methods should end using parentheses, but should not include expected parameters (parameters should be cover in documentation comments).</p><p><code>it</code> blocks should be declarative.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// BAD</span>
<span class=nx>it</span><span class=p>(</span><span class=s1>'should find generators'</span><span class=p>);</span>

<span class=c1>// GOOD</span>
<span class=nx>it</span><span class=p>(</span><span class=s1>'find generators'</span><span class=p>);</span>
</code></pre></div><h2>Assertion</h2><p>Don't add <code>message</code> to assertions unless the error thrown makes it unclear what failed.</p><p>If you must add a message, then describe the expected outcome and why it failed. For example:</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// BAD</span>
<span class=nx>assert</span><span class=p>(</span><span class=nx>Generator</span><span class=p>.</span><span class=nx>appname</span><span class=p>,</span> <span class=s1>'Generator have an `appname` property'</span><span class=p>);</span>

<span class=c1>// GOOD</span>
<span class=nx>assert</span><span class=p>(</span><span class=nx>Generator</span><span class=p>.</span><span class=nx>appname</span><span class=p>,</span> <span class=s1>'Expected Generator to have an `appname` property'</span><span class=p>);</span>
</code></pre></div><p>Remember that these message are the error message thrown with the failure. Let those be useful in these occasions.</p><h2>Stylistic preferences</h2><h4><code>.bind()</code> throwing assertions</h4><p>When testing that a method throw with invalid parameters, prefer binding the parameters to creating an anonymous function.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// BAD</span>
<span class=nx>assert</span><span class=p>.</span><span class=kr>throws</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=kr>class</span><span class=p>.</span><span class=nx>method</span><span class=p>(</span><span class=s1>'Invalid param'</span><span class=p>);</span>
<span class=p>});</span>

<span class=c1>// GOOD</span>
<span class=nx>assert</span><span class=p>.</span><span class=kr>throws</span><span class=p>(</span><span class=kr>class</span><span class=p>.</span><span class=nx>method</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=kr>class</span><span class=p>,</span> <span class=s1>'Invalid param'</span><span class=p>));</span>
</code></pre></div><h4>Never use scoped variables</h4><p>When creating test variables, always attach them to the <code>this</code> context. You're garanteed that <code>this</code> is a totally new object each time a test run. By comparison, scoped variables can easily leaks value and have side effects between tests.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=nx>describe</span><span class=p>(</span><span class=s1>'my module'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>foo</span><span class=p>;</span>

  <span class=nx>beforeEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=c1>// BAD</span>
    <span class=nx>foo</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>

    <span class=c1>// GOOD</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>foo</span> <span class=o>=</span> <span class=s1>'1'</span><span class=p>;</span>
  <span class=p>});</span>
<span class=p>});</span>
</code></pre></div></section></article></div></div><footer class=page-footer><ul class="footer-links footer-links-social"><li><a href=https://plus.google.com/101063139999404044459/posts class=icon><img src=/static/social-gplus.cdac08228d.svg alt=Google+></a></li> <li><a href=https://twitter.com/yeoman class=icon><img src=/static/social-twitter.60eb981a15.svg alt=Twitter></a></li> <li><a href=https://github.com/yeoman/yeoman class=icon><img src=/static/social-github.767995ad17.svg alt=Github></a></li> <li><a href=/blog/atom.xml class=icon><img src=/static/social-feed.c635057faf.svg alt=Feed></a></li></ul><ul class="footer-links footer-links-contribute"><li><a href="http://yeoman.github.io/generator/" class=btn>API</a></li> <li><a href=https://github.com/yeoman/yeoman.github.io/blob/source/app/contributing/testing-guidelines.md class="btn btn-improve" title="Edit this page on Github to help improve the site">Improve this page</a></li></ul></footer><script src=//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js></script><script src=/static/bundle-5393.12c59b403a.js async></script><script>!function(n,t,e){"undefined"!=typeof e.module&&e.module.exports?e.module.exports=t():"undefined"!=typeof e.define&&"function"==e.define&&e.define.amd?define(n,t):e[n]=t()}("$script",function(){function n(n,t){for(var e=0,o=n.length;o>e;++e)if(!t(n[e]))return l;return 1}function t(t,e){n(t,function(n){return!e(n)})}function e(r,c,l){function p(n){return n.call?n():u[n]}function g(){if(!--j){u[y]=1,v&&v();for(var e in s)n(e.split("|"),p)&&!t(s[e],p)&&(s[e]=[])}}r=r[m]?r:[r];var h=c&&c.call,v=h?c:l,y=h?r.join(""):c,j=r.length;return setTimeout(function(){t(r,function(n){return d[n]?(y&&(f[y]=1),2==d[n]&&g()):(d[n]=1,y&&(f[y]=1),o(!a.test(n)&&i?i+n+".js":n,g),void 0)})},0),e}function o(n,t){var e=r.createElement("script"),o=l;e.onload=e.onerror=e[v]=function(){e[g]&&!/^c|loade/.test(e[g])||o||(e.onload=e[v]=null,o=1,d[n]=2,t())},e.async=1,e.src=n,c.insertBefore(e,c.firstChild)}var i,r=document,c=r.getElementsByTagName("head")[0],a=/^https?:\/\//,u={},f={},s={},d={},l=!1,m="push",p="DOMContentLoaded",g="readyState",h="addEventListener",v="onreadystatechange";return!r[g]&&r[h]&&(r[h](p,function y(){r.removeEventListener(p,y,l),r[g]="complete"},l),r[g]="loading"),e.get=o,e.order=function(n,t,o){!function i(r){r=n.shift(),n.length?e(r,i):e(r,t,o)}()},e.path=function(n){i=n},e.ready=function(o,i,r){o=o[m]?o:[o];var c=[];return!t(o,function(n){u[n]||c[m](n)})&&n(o,function(n){return u[n]})?i():!function(n){s[n]=s[n]||[],s[n][m](i),r&&r(c)}(o.join("|")),e},e},this);var _gaq=[["_setAccount","UA-32956520-1"],["_setDomainName",".yeoman.io"],["_trackPageview"],["_trackPageLoadTime"]];$script("http://www.google-analytics.com/ga.js"),$script("https://apis.google.com/js/plusone.js"),$script("//platform.twitter.com/widgets.js");</script></body></html>