<!DOCTYPE html><html lang=en data-version=974c199><head><meta charset=utf-8><title>Step 7: Make Todos persistent with local storage | Yeoman</title><meta name=viewport content="width=device-width"><link rel=icon type=image/x-icon href=/static/favicon.b25e58c4b8.ico><meta name=google-site-verification content=fBQRJ6h7MV7_TJ7grbgq4P-d-07NRfDWPe4pqEEoH5w><link href="//fonts.googleapis.com/css?family=Roboto+Slab:400,700%7CRoboto:400,700,700italic,400italic" rel=stylesheet><link rel=stylesheet href=/static/bundle-4777.81f190fba0.css><link href=/blog/atom.xml type=application/atom+xml rel=alternate title="Yeoman Blog Atom Feed"></head><body><header class=page-header><div class=container><div class=mobile-bar><h1 class=logo><a href=/ ><img src=/static/logo.2a54d87108.png alt=Yeoman></a></h1><button class="mobile-menu-toggle ir">open</button></div><nav class=main-menu><ul class=main-nav><li><a href=/learning/ >Using Yeoman</a><ul> <li><a href=/learning/index.html>Getting started</a></li> <li><a href=/codelab/index.html>Tutorial (codelab)</a></li> <li><a href=/learning/resources.html>Resources</a></li> <li><a href=/learning/deployment.html>Deployment</a></li> <li><a href=/learning/faq.html>FAQ</a></li> <li><a href=/learning/support.html>Support</a></li></ul></li><li><a href=/generators/ >Discovering generators</a></li> <li><a href=/authoring/ >Creating a generator</a><ul> <li><a href=/authoring/index.html>Getting started</a></li> <li><a href=/authoring/running-context.html>Running Context</a></li> <li><a href=/authoring/user-interactions.html>User Interactions</a></li> <li><a href=/authoring/composability.html>Composability</a></li> <li><a href=/authoring/dependencies.html>Managing Dependencies</a></li> <li><a href=/authoring/file-system.html>Interacting with the file system</a></li> <li><a href=/authoring/storage.html>Storing user configs</a></li> <li><a href=/authoring/testing.html>Unit testing</a></li> <li><a href=/authoring/debugging.html>Debugging Generators</a></li> <li><a href=/authoring/integrating-yeoman.html>Integrating Yeoman in other tools</a></li> <li><a href=http://yeoman.io/generator/ >Full API documentation</a></li></ul></li><li><a href=/blog/ >Blog</a></li> <li><a href=/contributing/ >Contributing</a><ul> <li><a href=/contributing/index.html>Contributing</a></li> <li><a href=/contributing/opening-issues.html>How to open an issue</a></li> <li><a href=/contributing/pull-request.html>How to submit a PR</a></li> <li><a href=/contributing/style-guide.html>Style Guide</a></li> <li><a href=/contributing/testing-guidelines.html>Testing Guidelines</a></li> <li><a href=/contributing/ticketing.html>Issue system overview</a></li></ul></li></ul></nav></div></header><div class=SiteWrapper><div id=content><h2 class=page-title><span class=container>Step 7: Make Todos persistent with local storage</span></h2><div class="container clearfix has-sidebar"><nav class=context-nav><ul><li><a href=/codelab/index.html>Let’s Scaffold a Web App</a></li> <li><a href=/codelab/setup.html>Step 1</a></li> <li><a href=/codelab/install-generators.html>Step 2</a></li> <li><a href=/codelab/scaffold-app.html>Step 3</a></li> <li><a href=/codelab/review-generated-files.html>Step 4</a></li> <li><a href=/codelab/preview-inbrowser.html>Step 5</a></li> <li><a href=/codelab/run-unit-tests.html>Step 6</a></li> <li><a href=/codelab/local-storage.html>Step 7</a></li> <li><a href=/codelab/prepare-production.html>Step 8</a></li> <li><a href=/codelab/keep-going.html>Keep going</a></li></ul></nav><article class=main><section class=content-chunk><p>Let’s revisit the issue of items not persisting when the browser refreshes with our React/Redux <em>mytodo</em> app.</p><div class="note tip"><p>If the persistence is not a issue for you or you're short on time, you can skip this step and jump directly to <a href=keep-going.html>the Step 8 "Get ready for production"</a>.</p>.</div><h2 id=install-npm-package>Install npm package</h2><p>To easily achieve this, we can use another Redux module called “<a href=https://github.com/elgerlambert/redux-localstorage/tree/1.0-breaking-changes>redux-localstorage</a>” that will allow us to quickly implement <a href=http://diveintohtml5.info/storage.html>local storage</a>.</p><p>Run the following command:</p><div class="language-sh highlighter-rouge"><div class=highlight><pre class=highlight><code>npm install <span class=nt>--save</span> redux-localstorage@rc
</code></pre></div></div><p><img src=/static/07_install_localstorage.8aeb43f137.png alt=""></p><h2 id=use-redux-localstorage>Use redux-localstorage</h2><p>The Redux store should be configured to use storage. Replace the whole your <code class=highlighter-rouge>src/app/store/configureStore.js</code> by this code:</p><div class="language-js highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=k>import</span> <span class=p>{</span><span class=nx>compose</span><span class=p>,</span> <span class=nx>createStore</span><span class=p>}</span> <span class=k>from</span> <span class=s1>'redux'</span><span class=p>;</span>
<span class=k>import</span> <span class=nx>rootReducer</span> <span class=k>from</span> <span class=s1>'../reducers'</span><span class=p>;</span>

<span class=k>import</span> <span class=nx>persistState</span><span class=p>,</span> <span class=p>{</span><span class=nx>mergePersistedState</span><span class=p>}</span> <span class=k>from</span> <span class=s1>'redux-localstorage'</span><span class=p>;</span>
<span class=k>import</span> <span class=nx>adapter</span> <span class=k>from</span> <span class=s1>'redux-localstorage/lib/adapters/localStorage'</span><span class=p>;</span>

<span class=k>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>configureStore</span><span class=p>(</span><span class=nx>initialState</span><span class=p>)</span> <span class=p>{</span>
  <span class=kd>const</span> <span class=nx>reducer</span> <span class=o>=</span> <span class=nx>compose</span><span class=p>(</span>
    <span class=nx>mergePersistedState</span><span class=p>()</span>
  <span class=p>)(</span><span class=nx>rootReducer</span><span class=p>,</span> <span class=nx>initialState</span><span class=p>);</span>

  <span class=kd>const</span> <span class=nx>storage</span> <span class=o>=</span> <span class=nx>adapter</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>localStorage</span><span class=p>);</span>

  <span class=kd>const</span> <span class=nx>createPersistentStore</span> <span class=o>=</span> <span class=nx>compose</span><span class=p>(</span>
    <span class=nx>persistState</span><span class=p>(</span><span class=nx>storage</span><span class=p>,</span> <span class=s1>'state'</span><span class=p>)</span>
  <span class=p>)(</span><span class=nx>createStore</span><span class=p>);</span>

  <span class=kd>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>createPersistentStore</span><span class=p>(</span><span class=nx>reducer</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=nx>module</span><span class=p>.</span><span class=nx>hot</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Enable Webpack hot module replacement for reducers</span>
    <span class=nx>module</span><span class=p>.</span><span class=nx>hot</span><span class=p>.</span><span class=nx>accept</span><span class=p>(</span><span class=s1>'../reducers'</span><span class=p>,</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
      <span class=kd>const</span> <span class=nx>nextReducer</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>'../reducers'</span><span class=p>).</span><span class=k>default</span><span class=p>;</span>
      <span class=nx>store</span><span class=p>.</span><span class=nx>replaceReducer</span><span class=p>(</span><span class=nx>nextReducer</span><span class=p>);</span>
    <span class=p>});</span>
  <span class=p>}</span>

  <span class=k>return</span> <span class=nx>store</span><span class=p>;</span>
<span class=p>}</span>

</code></pre></div></div><p>If you look at your app in the browser, you’ll see that there are one item “Use Yeoman” in the todo list. The app is initialising the todos store if local storage is empty and we haven’t given it any todo items yet.</p><p><img src=/static/07_before_localstorage.068ca1a039.png alt=""></p><p>Go ahead and add a few items to the list:</p><p><img src=/static/07_after_localstorage.17f395442f.png alt=""></p><p>Now when we refresh our browser the items persist. Hooray!</p><p>We can confirm whether our data is being persisted to local storage by checking the <strong>Resources</strong> panel in Chrome DevTools and selecting <strong>Local Storage</strong> from the lefthand side:</p><p><img src=/static/07_show_localstorage.40c23235c9.png alt=""></p><div class="note tip"><h2>Write unit tests</h2><p>For an extra challenge, revisit unit testing in <a href=run-unit-tests.html>Step 6</a> and consider how you might update your tests now that the code is using local storage.</p></div><p class=codelab-paging><a href=#toc>« Return to overview</a> or <a href=prepare-production.html>Go to the next step »</a></p></section></article></div></div><footer class=SiteFooter><div class=SiteFooter-donation><div class=Donation><div class=Donation-sticker-clipping><img src=/static/yeoman-character-sticker.51cef7e007.png class=Donation-sticker width=190 height=294 alt=Stickers!></div><div class=Donation-text></div></div></div><ul class=SiteFooter-links><li><a href=https://plus.google.com/101063139999404044459/posts class=icon><img src=/static/social-gplus.5223e7bc73.svg class=SiteFooter-icon alt=Google+></a></li> <li><a href=https://twitter.com/yeoman class=icon><img src=/static/social-twitter.c359540fc8.svg class=SiteFooter-icon alt=Twitter></a></li> <li><a href=https://github.com/yeoman/yeoman class=icon><img src=/static/social-github.89959ef390.svg class=SiteFooter-icon alt=Github></a></li> <li><a href=/blog/atom.xml class=icon><img src=/static/social-feed.ad4bea7819.svg class=SiteFooter-icon alt=Feed></a></li> <li class=mobile-ln></li> <li><a href=http://yeoman.io/generator/ class="SiteFooter-button SiteFooter-button--light">API</a></li> <li><a href=https://github.com/yeoman/yeoman.github.io/blob/source/app/codelab/local-storage.md class=SiteFooter-button title="Edit this page on Github to help improve the site">Improve this page</a></li></ul></footer><script src=//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js></script><script src=/static/bundle-4836.976bf30fdb.js async></script><script>!function(a,b,c){'undefined'!=typeof c.module&&c.module.exports?c.module.exports=b():'undefined'!=typeof c.define&&'function'==c.define&&c.define.amd?define(a,b):c[a]=b()}('$script',function(){function a(a,b){for(var c=0,d=a.length;c<d;++c)if(!b(a[c]))return m;return 1}function b(b,c){a(b,function(a){return!c(a)})}function c(f,g,m){function o(a){return a.call?a():i[a]}function p(){if(!--t){i[s]=1,r&&r();for(var c in k)a(c.split('|'),o)&&!b(k[c],o)&&(k[c]=[])}}f=f[n]?f:[f];var q=g&&g.call,r=q?g:m,s=q?f.join(''):g,t=f.length;return setTimeout(function(){b(f,function(a){return l[a]?(s&&(j[s]=1),2==l[a]&&p()):(l[a]=1,s&&(j[s]=1),d(!h.test(a)&&e?e+a+'.js':a,p),void 0)})},0),c}function d(a,b){var c=f.createElement('script'),d=m;c.onload=c.onerror=c[r]=function(){c[p]&&!/^c|loade/.test(c[p])||d||(c.onload=c[r]=null,d=1,l[a]=2,b())},c.async=1,c.src=a,g.insertBefore(c,g.firstChild)}var e,f=document,g=f.getElementsByTagName('head')[0],h=/^https?:\/\//,i={},j={},k={},l={},m=!1,n='push',o='DOMContentLoaded',p='readyState',q='addEventListener',r='onreadystatechange';return!f[p]&&f[q]&&(f[q](o,function s(){f.removeEventListener(o,s,m),f[p]='complete'},m),f[p]='loading'),c.get=d,c.order=function(a,b,d){!function e(f){f=a.shift(),a.length?c(f,e):c(f,b,d)}()},c.path=function(a){e=a},c.ready=function(d,e,f){d=d[n]?d:[d];var g=[];return!b(d,function(a){i[a]||g[n](a)})&&a(d,function(a){return i[a]})?e():!function(a){k[a]=k[a]||[],k[a][n](e),f&&f(g)}(d.join('|')),c},c},this);var _gaq=[['_setAccount','UA-32956520-1'],['_setDomainName','.yeoman.io'],['_trackPageview'],['_trackPageLoadTime']];$script('https://www.google-analytics.com/ga.js'),$script('https://apis.google.com/js/plusone.js'),$script('//platform.twitter.com/widgets.js')//# sourceMappingURL=../static/yeoman-4948.5f42f0977f.map </script></div></body></html>